# MiniAuto éº¦å…‹çº³å§†è½®å°è½¦æ§åˆ¶å™¨

<div align="center">

**åŸºäº Flutter å¼€å‘çš„ Android BLE è“ç‰™æ§åˆ¶åº”ç”¨**

[![Flutter](https://img.shields.io/badge/Flutter-3.0+-02569B?logo=flutter)](https://flutter.dev)
[![Dart](https://img.shields.io/badge/Dart-3.0+-0175C2?logo=dart)](https://dart.dev)

</div>

---

## é¡¹ç›®è¯´æ˜

è¿™æ˜¯é…åˆ **Hiwonder å¹»å°”ç§‘æŠ€** è´­ä¹°çš„ **miniAuto éº¦å…‹çº³å§†è½®å°è½¦** ä½¿ç”¨çš„æ‰‹æœºæ§åˆ¶ç«¯åº”ç”¨ã€‚

**æ³¨æ„**: æœ¬é¡¹ç›®æ˜¯è‡ªå­¦çš„ä¸´æ—¶äº§ç‰©,å°šä¸æˆç†Ÿ,ä»…ä¾›å‚è€ƒå­¦ä¹ ã€‚

### ç¡¬ä»¶æ¶æ„

ç”±äºå°è½¦è‡ªå¸¦çš„è“ç‰™æ¨¡å—æŸå,é‡‡ç”¨ä»¥ä¸‹æ”¹é€ æ–¹æ¡ˆ:

```
æ‰‹æœº APP (Flutter)
    â†“ BLE è“ç‰™ (FFE0/FFE1)
ESP32S3-Cam æ¨¡å— (BLEè½¬å‘å›ºä»¶)
    â†“ I2C æ¥å£
Arduino Uno æ¨¡å— (éº¦è½®é©±åŠ¨å›ºä»¶)
    â†“ PWM + æ–¹å‘æ§åˆ¶
éº¦å…‹çº³å§†è½®å°è½¦ (4ä¸ªç”µæœº)
```

**éœ€è¦é…åˆå›ºä»¶**:
- ESP32S3 è½¬å‘å›ºä»¶: [esp32s3_ble_test](https://github.com/fly3457/hiwonder-miniauto-arduino-agent/tree/main/esp32s3_ble_test)
- Arduino Uno é©±åŠ¨å›ºä»¶: [app_control_common_a](https://github.com/fly3457/hiwonder-miniauto-arduino-agent/tree/main/app_control_common_a)

**å®Œæ•´ä»“åº“**: https://github.com/fly3457/hiwonder-miniauto-arduino-agent

---

## é€šä¿¡åè®®

### BLE è¿æ¥å‚æ•°

| å‚æ•° | å€¼ |
|------|-----|
| è“ç‰™æ¨¡å— | ESP32S3-Cam (å…¼å®¹ HM-10) |
| æœåŠ¡ UUID | `0000FFE0-0000-1000-8000-00805F9B34FB` |
| ç‰¹å¾ UUID | `0000FFE1-0000-1000-8000-00805F9B34FB` |
| é€šä¿¡æ–¹å¼ | æ”¶å‘å…±ç”¨ (éœ€å¯ç”¨ notify) |

### æŒ‡ä»¤æ ¼å¼

**åè®®æ ¼å¼**: `X|data1|data2|...|$`

#### è¿åŠ¨æ§åˆ¶ (A å‘½ä»¤)

```
æ ¼å¼: A|state|$
```

| state | åŠŸèƒ½ | state | åŠŸèƒ½ |
|-------|------|-------|------|
| 0 | å³ç§» (90Â°) | 1 | å³å‰ (45Â°) |
| 2 | å‰è¿› (0Â°) | 3 | å·¦å‰ (315Â°) |
| 4 | å·¦ç§» (270Â°) | 5 | å·¦å (225Â°) |
| 6 | åé€€ (180Â°) | 7 | å³å (135Â°) |
| 8 | åœæ­¢ | 9 | é¡ºæ—¶é’ˆæ—‹è½¬ |
| 10 | é€†æ—¶é’ˆæ—‹è½¬ | - | - |

**ç¤ºä¾‹**: `A|2|$` (å‰è¿›), `A|8|$` (åœæ­¢)

#### RGB ç¯å…‰ (B å‘½ä»¤)

```
æ ¼å¼: B|r|g|b|$
å‚æ•°: r/g/b èŒƒå›´ 0-255
```

**ç¤ºä¾‹**: `B|255|0|0|$` (çº¢è‰²), `B|0|0|0|$` (å…³ç¯)

#### é€Ÿåº¦æ§åˆ¶ (C å‘½ä»¤)

```
æ ¼å¼: C|speed|$
å‚æ•°: speed èŒƒå›´ 20-100
```

**ç¤ºä¾‹**: `C|50|$` (ä¸­é€Ÿ), `C|100|$` (å…¨é€Ÿ)

#### æ•°æ®è¯·æ±‚ (D å‘½ä»¤)

```
æ ¼å¼: D|$
è¿”å›: $distance,voltage$
```

distance: è¶…å£°æ³¢è·ç¦» (mm), voltage: ç”µæ± ç”µå‹ (mV)

**ç¤ºä¾‹è¿”å›**: `$150,8200$` (è·ç¦»150mm, ç”µå‹8.2V)

#### ç”µæœºæµ‹è¯• (G å‘½ä»¤)

```
æ ¼å¼: G|motorId|speed|$
å‚æ•°: motorId (0-3), speed (-100åˆ°100)
```

ç”µæœºç¼–å·: 0=å·¦å‰, 1=å³å‰, 2=å·¦å, 3=å³å

**ç¤ºä¾‹**: `G|0|50|$` (å·¦å‰è½®æ­£è½¬,é€Ÿåº¦50)

---

## åŠŸèƒ½ç‰¹æ€§

- **åŒæ¨¡å¼æ§åˆ¶**: ç®€æ˜“æ¨¡å¼ (4æ–¹å‘) / é«˜çº§æ¨¡å¼ (8æ–¹å‘+æ—‹è½¬)
- **HSB è‰²ç›¸æ»‘å—**: å½©è™¹æ¸å˜èƒŒæ™¯,ç›´è§‚é€‰æ‹©é¢œè‰² (0-360Â°)
- **å®æ—¶ç›‘æµ‹**: ç”µæ± ç”µé‡ç™¾åˆ†æ¯”ã€ç”µå‹å€¼ã€è¶…å£°æ³¢è·ç¦»
- **è·ç¦»ä¿æŠ¤**: å‰è¿›æ—¶è·ç¦» < 10cm è‡ªåŠ¨åœæ­¢
- **ç”µæœºæ£€æµ‹å·¥å…·**: é€ä¸ªæµ‹è¯•4ä¸ªç”µæœºæ­£åè½¬,ç”Ÿæˆæ£€æµ‹æŠ¥å‘Š
- **è‡ªåŠ¨é‡è¿**: å¯åŠ¨æ—¶è‡ªåŠ¨è¿æ¥ä¸Šæ¬¡è®¾å¤‡
- **æŒ‡ä»¤ä¼˜åŒ–**: å»é‡æœºåˆ¶ã€ä¼˜å…ˆçº§é˜Ÿåˆ—ã€åœæ­¢æŒ‡ä»¤é‡å¤å‘é€3æ¬¡

---

## å¿«é€Ÿå¼€å§‹

### å®‰è£…ä¾èµ–

```bash
cd hiwonder-miniauto-android-controller
flutter pub get
```

### è¿è¡Œ

```bash
flutter run
```

### æ„å»º APK

```bash
flutter build apk --release
# è¾“å‡º: build/app/outputs/flutter-apk/app-release.apk
```

### ä½¿ç”¨æ­¥éª¤

1. ç¡®ä¿å°è½¦å·²å¼€æœº,ESP32S3 è“ç‰™æ­£å¸¸
2. æ‰“å¼€åº”ç”¨,æˆäºˆè“ç‰™å’Œä½ç½®æƒé™
3. å¼€å¯æ‰‹æœºä½ç½®æœåŠ¡ (GPS) - Android BLE æ‰«æå¼ºåˆ¶è¦æ±‚
4. ç‚¹å‡»æ‰«æ,é€‰æ‹©è®¾å¤‡è¿æ¥
5. ä½¿ç”¨åº•éƒ¨æ§åˆ¶æŒ‰é’®æ“ä½œå°è½¦

---

## é¡¹ç›®ç»“æ„

```
lib/
â”œâ”€â”€ main.dart                 # ä¸»ç•Œé¢,è¿æ¥çŠ¶æ€ã€æ§åˆ¶æŒ‰é’®
â”œâ”€â”€ bluetooth_service.dart    # BLE é€šä¿¡æœåŠ¡
â”œâ”€â”€ settings_page.dart        # è®¾ç½®é¡µé¢
â””â”€â”€ motor_test_page.dart      # ç”µæœºæ£€æµ‹é¡µé¢
```

---

## å¼€å‘ç¯å¢ƒ

- **Flutter SDK**: 3.0+
- **Dart SDK**: 3.0+
- **Android SDK**: API 21+ (Android 5.0+)

### ä¾èµ–åº“

```yaml
flutter_blue_plus: ^1.32.0     # BLE è“ç‰™é€šä¿¡
permission_handler: ^11.0.0    # æƒé™ç®¡ç†
shared_preferences: ^2.2.2     # æœ¬åœ°å­˜å‚¨
location: ^5.0.0               # ä½ç½®æœåŠ¡æ£€æµ‹
```

---

## æ›´æ–°æ—¥å¿—

### v1.0.0 (2026-01-14)

- åè®®ç»Ÿä¸€: åœæ­¢æŒ‡ä»¤ä½¿ç”¨ `A|8|$`
- å¯é æ€§å¢å¼º: åœæ­¢æŒ‡ä»¤é‡å¤å‘é€3æ¬¡
- æŒ‡ä»¤å»é‡æœºåˆ¶
- HSB è‰²ç›¸æ»‘å—ç¯å…‰æ§åˆ¶
- ç”µæœºæ£€æµ‹åŠŸèƒ½
- è·ç¦»ä¿æŠ¤åŠŸèƒ½

### v0.2.0 (2026-01-09)

- åè®®å˜æ›´: ä»äºŒè¿›åˆ¶åè®®æ”¹ä¸ºå­—ç¬¦ä¸²åè®® `X|data|$`

### v0.1.0 (2026-01-08)

- é¦–æ¬¡æäº¤: BLE è¿æ¥ã€åŸºç¡€è¿åŠ¨æ§åˆ¶ã€ç¯å…‰æ§åˆ¶

---

## ç›¸å…³æ–‡æ¡£

- **Arduino ç«¯å›ºä»¶ä»“åº“**: https://github.com/fly3457/hiwonder-miniauto-arduino-agent
- **CLAUDE.md**: Claude Code å¼€å‘æŒ‡å—
- **BUILD.md**: ç¼–è¯‘å’Œæµ‹è¯•è¯´æ˜

---

## è®¸å¯è¯

æœ¬é¡¹ç›®ç”¨äºå­¦ä¹ å’Œç ”ç©¶ç›®çš„ã€‚

---

<div align="center">

Made with Flutter ğŸš€

</div>
